<!doctype html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <!--<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"-->
  <!--integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="-->
  <!--crossorigin=""/>-->
  <!--<link rel="stylesheet" href="css/timeliner.css" type="text/css" media="screen">-->

  <!-- Import leaflet.js javascript API library -->
  <!--<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"-->
  <!--integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="-->
  <!--crossorigin=""></script>-->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <!-- Title -->
  <title>Video Game Visualization</title>
</head>
<style>
  /* Small devices (landscape phones, 576px and up) */
  @media (min-width: 576px) {
  }

  /* Medium devices (tablets, 768px and up) */
  @media (min-width: 768px) {
  }

  /* Large devices (desktops, 992px and up) */
  @media (min-width: 992px) {
  }

  /* Extra large devices (large desktops, 1200px and up) */
  @media (min-width: 1200px) {
  }

  /* Small devices (landscape phones, 576px and up) */
  @media (min-width: 576px) {
  }

  /* Medium devices (tablets, 768px and up) */
  @media (min-width: 768px) {
  }

  /* Large devices (desktops, 992px and up) */
  @media (min-width: 992px) {
  }

  /* Extra large devices (large desktops, 1200px and up) */
  @media (min-width: 1200px) {
  }

  body {
    font-family: Sans-serif;
    font-size: 11px;
  }

  .slice {
    cursor: pointer;
  }

  .slice .main-arc {
    stroke: #fff;
    stroke-width: 1px;
  }

  .slice .hidden-arc {
    fill: none;
  }

  .slice text {
    pointer-events: none;
    dominant-baseline: middle;
    text-anchor: middle;
  }
</style>
<body onload="readFiles();">
<div id="gameDashboard">
  <h1 id="vgdashtitle" style="text-align: center" class="display-1"></h1>
  <hr>
  <div id="stockLine"></div>
  <div id="summary"><span id="summaryText"></span></div>
</div>
<script src='https://d3js.org/d3.v4.min.js'></script>
<script src="js/dataReading.js"></script>
<script src="js/sunburst.js"></script>
<script src="js/readStocks.js"></script>
<script src="js/drawStocks.js"></script>

<script type="text/javascript">
  function doneLoadingData() {
    // This is to get the value that was passed!
    document.getElementById('vgdashtitle').innerText = localStorage.getItem("chosenCompany") + ' Dashboard';

    var genres = [];
    var regions = ['Other_Sales', 'EU_Sales', 'NA_Sales', 'JP_Sales'];
    var genreSales = [];
    var regionSales = [];
    var genreRegionSales = {
      name: localStorage.getItem("chosenCompany"),
      children: []
    };

    for (let i = 0; i < vgsData.length; i++) {
      genres.push(vgsData[i].Genre);
    }
    genres = [... new Set(genres)];
    genres.pop();
    console.log(vgsData);
    console.log(genres);
    for (let i = 0; i < genres.length; i++) {
      genreRegionSales.children.push({
        name: genres[i],
        children: [
          {
            name: 'NA',
            size: 0
          },
          {
            name: 'JP',
            size: 0
          },
          {
            name: 'EU',
            size: 0
          },
          {
            name: 'OTH',
            size: 0
          }
        ]
      });
    }
    for (let i = 0; i < vgsData.length; i++) {
      for (let j = 0; j < genreRegionSales.children.length; j++) {
        if (vgsData[i].Genre == genreRegionSales.children[j].name && vgsData[i].Publisher == localStorage.getItem("chosenCompany")) {
          genreRegionSales.children[j].children[0].size += parseFloat(vgsData[i].NA_Sales);
          genreRegionSales.children[j].children[1].size += parseFloat(vgsData[i].JP_Sales);
          genreRegionSales.children[j].children[2].size += parseFloat(vgsData[i].EU_Sales);
          genreRegionSales.children[j].children[3].size += parseFloat(vgsData[i].Other_Sales);
        }
      }
    }
    newSunBurst(genreRegionSales);
  }
</script>
<script src="js/traceMaker.js"></script>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script
    src="https://code.jquery.com/jquery-3.3.1.js"
    integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous"></script>
<!--<script type="text/javascript" src="js/timeliner.js"></script>-->
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
</body>
</html>
